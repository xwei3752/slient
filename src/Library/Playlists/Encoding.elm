module Playlists.Encoding exposing (decoder, encode, encodePlaylistTrack, playlistTrackDecoder)

import Json.Decode as Decode
import Json.Encode as Encode
import Playlists exposing (..)



-- ENCODE


encode : Playlist -> Encode.Value
encode playlist =
    Encode.object
        [ ( "autoGenerated", Encode.bool playlist.autoGenerated )
        , ( "name", Encode.string playlist.name )
        , ( "tracks", Encode.list encodePlaylistTrack playlist.tracks )
        ]


encodePlaylistTrack : PlaylistTrack -> Encode.Value
encodePlaylistTrack playlistTrack =
    Encode.object
        [ ( "album", Encode.string playlistTrack.album )
        , ( "artist", Encode.string playlistTrack.artist )
        , ( "title", Encode.string playlistTrack.title )
        ]



-- DECODE


decoder : Decode.Decoder Playlist
decoder =
    Decode.map3 Playlist
        (Decode.field "autoGenerated" Decode.bool)
        (Decode.field "name" Decode.string)
        (Decode.field "tracks" <| Decode.list playlistTrackDecoder)


playlistTrackDecoder : Decode.Decoder PlaylistTrack
playlistTrackDecoder =
    Decode.map3 PlaylistTrack
        (Decode.field "album" Decode.string)
        (Decode.field "artist" Decode.string)
        (Decode.field "title" Decode.string)
